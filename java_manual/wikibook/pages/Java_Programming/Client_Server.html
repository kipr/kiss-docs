<html><head><title>Java Programming/Client Server</title><link media="all" href="../../misc/modern.css" type="text/css" rel="stylesheet"></head><body class="mediawiki"><div id="content"><h1 class="firstHeading" id="firstHeading">Java Programming/Client Server</h1><div id="bodyContent">
								
				
				
								
				
				
																
				
				
								
				<div lang="en" dir="ltr" class="mw-content-ltr"><p><b>Concurrent Programming</b> topics</p>
<ul><li><a href="Threads_and_Runnables.html" title="Java Programming/Threads and Runnables">Threads and Runnables</a> </li>
<li><a href="Basic_Synchronization.html" title="Java Programming/Basic Synchronization">Basic Synchronization</a> </li>
<li><strong class="selflink">Client Server Programming</strong> </li>
<li><a href="Remote_Method_Invocation.html" title="Java Programming/Remote Method Invocation">Remote Method Invocation(RMI)</a> </li>
<li><a href="EJB.html" title="Java Programming/EJB">Enterprise JavaBean Programming</a> </li>
<li><a href="Jini.html" title="Java Programming/Jini">Jini-Java Spaces Programming</a> </li>
</ul><p>In 1990s, the trend was moving away from <a href="http://en.wikipedia.org/wiki/Mainframe_computer" class="extiw" title="w:Mainframe computer">Mainframe computing</a> to Client/Server, as the price of Unix servers dropped. The database access and some business logic were centralized on the <a href="http://en.wikipedia.org/wiki/Front-end_and_back-end" class="extiw" title="w:Front-end and back-end">back-end</a> server, collecting data from the user program was installed on the <a href="http://en.wikipedia.org/wiki/Front-end_and_back-end" class="extiw" title="w:Front-end and back-end">front-end</a> users' "client" computers. In the Java world there are three main ways the front-end and the back-end could simply communicate.</p>
<ul><li>The client application using JDBC to connect the data base server, (Limited business logic on the back-end, unless using <a href="http://en.wikipedia.org/wiki/Stored_procedure" class="extiw" title="w:Stored procedure">Stored procedures</a>)</li>
<li>The client application using RMI(<a href="Remote_Method_Invocation.html" title="Java Programming/Remote Method Invocation">Remote Method Invocation</a>) to communicate with the back-end.</li>
<li>The client application using <a href="http://en.wikipedia.org/wiki/Server_socket" class="extiw" title="w:Server socket">socket connection</a> to communicate with the back-end.</li>
</ul><table id="toc" class="toc"><tr><td>
<div id="toctitle">
<h2>Contents</h2>
</div>
<ul><li class="toclevel-1 tocsection-1"><a href="http://en.wikibooks.org/w/index.php?title=Java_Programming/Client_Server&amp;printable=yes#Socket_Connection_Example"><span class="tocnumber">1</span> <span class="toctext">Socket Connection Example</span></a>
<ul><li class="toclevel-2 tocsection-2"><a href="http://en.wikibooks.org/w/index.php?title=Java_Programming/Client_Server&amp;printable=yes#Create_a_Server"><span class="tocnumber">1.1</span> <span class="toctext">Create a Server</span></a>
<ul><li class="toclevel-3 tocsection-3"><a href="http://en.wikibooks.org/w/index.php?title=Java_Programming/Client_Server&amp;printable=yes#Listening_on_a_port"><span class="tocnumber">1.1.1</span> <span class="toctext">Listening on a port</span></a></li>
<li class="toclevel-3 tocsection-4"><a href="http://en.wikibooks.org/w/index.php?title=Java_Programming/Client_Server&amp;printable=yes#Service_One_Client"><span class="tocnumber">1.1.2</span> <span class="toctext">Service One Client</span></a></li>
<li class="toclevel-3 tocsection-5"><a href="http://en.wikibooks.org/w/index.php?title=Java_Programming/Client_Server&amp;printable=yes#Handling_the_request.3B_implements_the_communication_protocol"><span class="tocnumber">1.1.3</span> <span class="toctext">Handling the request; implements the communication protocol</span></a></li>
<li class="toclevel-3 tocsection-6"><a href="http://en.wikibooks.org/w/index.php?title=Java_Programming/Client_Server&amp;printable=yes#The_Data_object_that_goes_through_the_network"><span class="tocnumber">1.1.4</span> <span class="toctext">The Data object that goes through the network</span></a></li>
</ul></li>
<li class="toclevel-2 tocsection-7"><a href="http://en.wikibooks.org/w/index.php?title=Java_Programming/Client_Server&amp;printable=yes#Create_the_Client"><span class="tocnumber">1.2</span> <span class="toctext">Create the Client</span></a></li>
</ul></li>
</ul></td>
</tr></table><h1> <span class="mw-headline" id="Socket_Connection_Example">Socket Connection Example</span></h1>
<div class="thumb tright">
<div class="thumbinner" style="width:516px;"><a href="http://en.wikibooks.org/wiki/File:Java_client_server.jpg" class="image"><img alt="" src="../../thumbs/03260_Java_client_server.jpg" width="514" height="346" class="thumbimage"></a>
<div class="thumbcaption">
<div class="magnify"><a href="http://en.wikibooks.org/wiki/File:Java_client_server.jpg" class="internal" title="Enlarge"><img src="../../thumbs/6d83a_magnify-clip.png" width="15" height="11" alt=""></a></div>
Figure 1:Simple Client Server Implementation</div>
</div>
</div>
<p>In this page there is an example for socket connection.</p>
<h2> <span class="mw-headline" id="Create_a_Server">Create a Server</span></h2>
<p>Java language was developed having network computing in mind. For this reason it is very easy to create a server program. A server is a piece of code that runs all the time listening on a particular port on the computer for incoming request. When a request arrives, it starts a new thread to service the request. See the following example:</p>
<hr><h3> <span class="mw-headline" id="Listening_on_a_port">Listening on a port</span></h3>
<dl><dt>ComServer&#160;</dt>
<dd>class is for listening on a port for a client.</dd>
</dl><div dir="ltr" class="mw-geshi" style="text-align: left;">
<div class="java source-java">
<pre class="de1">
<span class="kw1">import</span> <span class="co2">java.net.ServerSocket</span><span class="sy0">;</span>
<span class="co3">/**
 * -- Main Server Class; Listening on a port for client; If there is a client,
 * starts a new Thread and goes back to listening for further clients. --
 */</span>
<span class="kw1">public</span> <span class="kw1">class</span> ComServer 
<span class="br0">{</span>
<span class="kw1">static</span> <span class="kw4">boolean</span>  GL_listening <span class="sy0">=</span> <span class="kw2">true</span><span class="sy0">;</span>
   <span class="co3">/**
    * -- Main program to start the Server --
    */</span>
   <span class="kw1">public</span> <span class="kw1">static</span> <span class="kw4">void</span> main<span class="br0">(</span><span class="kw3">String</span><span class="br0">[</span><span class="br0">]</span> args<span class="br0">)</span> <span class="kw1">throws</span> <span class="kw3">IOException</span>
   <span class="br0">{</span>
      ComServer srv <span class="sy0">=</span> <span class="kw1">new</span> ComServer<span class="br0">(</span><span class="br0">)</span><span class="sy0">;</span>
      srv.<span class="me1">listen</span><span class="br0">(</span><span class="br0">)</span><span class="sy0">;</span> 
   <span class="br0">}</span> <span class="co1">// --- End of Main Method ---</span>
 
   <span class="co3">/**
    * -- Server method; Listen for client --
    */</span>
   <span class="kw1">public</span> <span class="kw4">int</span> listen<span class="br0">(</span><span class="br0">)</span> <span class="kw1">throws</span> <span class="kw3">IOException</span>
   <span class="br0">{</span>
    <span class="kw3">ServerSocket</span> serverSocket <span class="sy0">=</span> <span class="kw2">null</span><span class="sy0">;</span>
    <span class="kw4">int</span> iPortNumber <span class="sy0">=</span> <span class="nu0">9090</span><span class="sy0">;</span>
 
       <span class="co1">// --- Open the Server Socket where this should listen ---</span>
       <span class="kw1">try</span> <span class="br0">{</span>
           <span class="kw3">System</span>.<span class="me1">out</span>.<span class="me1">println</span><span class="br0">(</span> <span class="st0">"*** Open the listening socket; at:"</span><span class="sy0">+</span> iPortNumber <span class="sy0">+</span> <span class="st0">" ***"</span> <span class="br0">)</span><span class="sy0">;</span>
           serverSocket <span class="sy0">=</span> <span class="kw1">new</span> <span class="kw3">ServerSocket</span><span class="br0">(</span> iPortNumber <span class="br0">)</span><span class="sy0">;</span>
       <span class="br0">}</span> <span class="kw1">catch</span> <span class="br0">(</span><span class="kw3">IOException</span> e<span class="br0">)</span> <span class="br0">{</span>
           <span class="kw3">System</span>.<span class="me1">err</span>.<span class="me1">println</span><span class="br0">(</span><span class="st0">"Could not listen on port:"</span><span class="sy0">+</span>iPortNumber <span class="br0">)</span><span class="sy0">;</span>
           <span class="kw3">System</span>.<span class="me1">exit</span><span class="br0">(</span><span class="nu0">1</span><span class="br0">)</span><span class="sy0">;</span>
       <span class="br0">}</span>
       <span class="kw1">while</span> <span class="br0">(</span> GL_listening <span class="br0">)</span>
       <span class="br0">{</span>
        ComServerThread clientServ<span class="sy0">;</span> 
           <span class="co1">// --- Listening for client; If there is a client start a Thread -</span>
           <span class="kw3">System</span>.<span class="me1">out</span>.<span class="me1">println</span><span class="br0">(</span> <span class="st0">"*** Listen for a Client; at:"</span><span class="sy0">+</span> iPortNumber <span class="sy0">+</span> <span class="st0">" ***"</span> <span class="br0">)</span><span class="sy0">;</span>
           clientServ <span class="sy0">=</span> <span class="kw1">new</span> ComServerThread<span class="br0">(</span> serverSocket.<span class="me1">accept</span><span class="br0">(</span><span class="br0">)</span> <span class="br0">)</span><span class="sy0">;</span>
           <span class="co1">// --- Service a Client ---</span>
           <span class="kw3">System</span>.<span class="me1">out</span>.<span class="me1">println</span><span class="br0">(</span> <span class="st0">"*** A Client came; Service it ***"</span> <span class="br0">)</span><span class="sy0">;</span>
           clientServ.<span class="me1">start</span><span class="br0">(</span><span class="br0">)</span><span class="sy0">;</span>   <span class="coMULTI">/* --- Use for multy Threaded --- */</span>
      <span class="co1">//     clientServ.run();    /* --- Use for Single Threaded --- */</span>
       <span class="br0">}</span>
 
       <span class="co1">// --- Close the Server socket;  Server exiting ---</span>
       serverSocket.<span class="me1">close</span><span class="br0">(</span><span class="br0">)</span><span class="sy0">;</span>
    <span class="kw1">return</span> <span class="nu0">0</span><span class="sy0">;</span>
   <span class="br0">}</span> <span class="co1">// --- End of listen Method --- </span>
<span class="br0">}</span>  <span class="co1">// --- End of ComServer Class ---</span>
</pre></div>
</div>
<dl><dt>ServerSocket( iPortNumber )&#160;</dt>
<dd>Creates a server socket, bound to the specified port.</dd>
<dt>serverSocket.accept()&#160;</dt>
<dd>Listens for a connection to be made to this socket and accepts it. The method blocks until a connection is made. It returns a new Socket.</dd>
</dl><h3> <span class="mw-headline" id="Service_One_Client">Service One Client</span></h3>
<dl><dt>ComServerThread&#160;</dt>
<dd>This class extended from a Thread; Responsible to service one client. The Socket connection will be open between the client and server. A simple protocol has to be defined between the client and server, the server has to understand what the client wants from the server. The client will send a 'terminate' command, for which the server will terminate the socket connection. The ComServerThread class is responsible to handle a client request, until the client sends a 'terminate' command.</dd>
</dl><div dir="ltr" class="mw-geshi" style="text-align: left;">
<div class="java source-java">
<pre class="de1">
 <span class="co3">/**
  * -- A class extended from a Thread; Responsible to service one client --
  */</span>
 <span class="kw1">class</span> <span class="st0">''</span><span class="st0">'ComServerThread'</span><span class="st0">''</span> <span class="kw1">extends</span> <span class="kw3">Thread</span>
 <span class="br0">{</span>
    <span class="kw1">private</span> <span class="kw3">Socket</span> clientSocket <span class="sy0">=</span> <span class="kw2">null</span><span class="sy0">;</span>
    COM_DATA tDataFromClient<span class="sy0">;</span>
    COM_DATA tDataToClient<span class="sy0">;</span> 
    <span class="kw3">ObjectInputStream</span> oIn<span class="sy0">;</span>
    <span class="kw3">ObjectOutputStream</span> oOut<span class="sy0">;</span>
    <span class="co3">/**
     * -- Constructor --
     */</span>
    <span class="kw1">public</span> ComServerThread<span class="br0">(</span> <span class="kw3">Socket</span> socket <span class="br0">)</span>
    <span class="br0">{</span>
       <span class="kw1">super</span><span class="br0">(</span> <span class="st0">"ComServerThread"</span> <span class="br0">)</span><span class="sy0">;</span>
       <span class="kw1">this</span>.<span class="me1">clientSocket</span> <span class="sy0">=</span> socket<span class="sy0">;</span>
    <span class="br0">}</span> <span class="co1">// -- End of ComServerThread() constructor --</span>
    <span class="co3">/**
     * -- Overrun from the Thread (super) class --
     */</span>
    <span class="kw1">public</span> <span class="br0">{</span><span class="br0">{</span>java<span class="sy0">:</span><span class="kw4">void</span><span class="br0">}</span><span class="br0">}</span> run<span class="br0">(</span><span class="br0">)</span>
    <span class="br0">{</span>
       <span class="kw1">try</span> <span class="br0">{</span>
          <span class="co1">// --- Create the Writer; will be used to send data to client ---</span>
          oOut <span class="sy0">=</span> <span class="kw1">new</span> <span class="kw3">ObjectOutputStream</span><span class="br0">(</span> clientSocket.<span class="me1">getOutputStream</span><span class="br0">(</span><span class="br0">)</span> <span class="br0">)</span><span class="sy0">;</span>
          <span class="co1">// --- Create the Reader; will be used to get data from client ---</span>
          oIn  <span class="sy0">=</span> <span class="kw1">new</span> <span class="kw3">ObjectInputStream</span><span class="br0">(</span> clientSocket.<span class="me1">getInputStream</span><span class="br0">(</span><span class="br0">)</span> <span class="br0">)</span><span class="sy0">;</span>
          <span class="co1">// --- Create a new protocol object ---</span>
          ComProtocol comp <span class="sy0">=</span> <span class="kw1">new</span> ComProtocol<span class="br0">(</span><span class="br0">)</span><span class="sy0">;</span>
          <span class="co1">// --- Send something to client to indicate that server is ready ---</span>
          tDataToClient  <span class="sy0">=</span> <span class="st0">''</span><span class="st0">'comp.processInput( null );'</span><span class="st0">''</span>
          <span class="st0">''</span><span class="st0">'sendDataToClient'</span><span class="st0">''</span><span class="br0">(</span> tDataToClient, oOut <span class="br0">)</span><span class="sy0">;</span>
          <span class="co1">// --- Get the data from the client ---</span>
          <span class="kw1">while</span> <span class="br0">(</span> <span class="kw2">true</span> <span class="br0">)</span>
          <span class="br0">{</span>
             <span class="kw1">try</span> <span class="br0">{</span>
                tDataFromClient <span class="sy0">=</span> <span class="st0">''</span><span class="st0">'getDataFromClient( oIn )'</span><span class="st0">''</span><span class="sy0">;</span>
                <span class="co1">// --- Parse the request and get the reply ---</span>
                tDataToClient <span class="sy0">=</span> <span class="st0">''</span><span class="st0">'comp.processInput( tDataFromClient );'</span><span class="st0">''</span>
                <span class="co1">// --- Send data to the Client ---</span>
                <span class="st0">''</span><span class="st0">'sendDataToClient'</span><span class="st0">''</span><span class="br0">(</span> tDataToClient, oOut <span class="br0">)</span><span class="sy0">;</span>
             <span class="br0">}</span>
             <span class="kw1">catch</span> <span class="br0">(</span> <span class="kw3">EOFException</span> e <span class="br0">)</span> <span class="br0">{</span>
                <span class="kw3">System</span>.<span class="me1">out</span>.<span class="me1">println</span><span class="br0">(</span> <span class="st0">"Client Disconnected, Bye, Bye"</span> <span class="br0">)</span><span class="sy0">;</span>
                <span class="kw1">break</span><span class="sy0">;</span>
             <span class="br0">}</span>
             <span class="co1">// --- See if the Client wanted to terminate the connection ---</span>
             <span class="kw1">if</span> <span class="br0">(</span> tDataToClient.<span class="me1">bExit</span> <span class="br0">)</span>
             <span class="br0">{</span>
                <span class="kw3">System</span>.<span class="me1">out</span>.<span class="me1">println</span><span class="br0">(</span> <span class="st0">"Client said Bye. Bye"</span> <span class="br0">)</span><span class="sy0">;</span>
                <span class="kw1">break</span><span class="sy0">;</span>
             <span class="br0">}</span>
          <span class="br0">}</span>
          <span class="co1">// --- Close resources;  This client is gone ---</span>
          comp.<span class="kw1">Final</span><span class="br0">(</span><span class="br0">)</span><span class="sy0">;</span>
          oOut.<span class="me1">close</span><span class="br0">(</span><span class="br0">)</span><span class="sy0">;</span>
          oIn.<span class="me1">close</span><span class="br0">(</span><span class="br0">)</span><span class="sy0">;</span>
          clientSocket.<span class="me1">close</span><span class="br0">(</span><span class="br0">)</span><span class="sy0">;</span>
       <span class="br0">}</span> <span class="kw1">catch</span> <span class="br0">(</span> <span class="kw3">IOException</span> e <span class="br0">)</span> <span class="br0">{</span>
        e.<span class="me1">printStackTrace</span><span class="br0">(</span><span class="br0">)</span><span class="sy0">;</span>
       <span class="br0">}</span>
    <span class="br0">}</span> <span class="co1">// -- End of run() Method --</span>
    <span class="co3">/**
     * Get data from Client 
     */</span>
    <span class="kw1">private</span> <span class="kw1">static</span> COM_DATA <span class="st0">''</span><span class="st0">'getDataFromClient'</span><span class="st0">''</span><span class="br0">(</span> <span class="kw3">ObjectInputStream</span> oIn <span class="br0">)</span> <span class="kw1">throws</span> <span class="kw3">IOException</span>                                                                         
    <span class="br0">{</span>
        COM_DATA  tDataFromClient <span class="sy0">=</span> <span class="kw2">null</span><span class="sy0">;</span>         
        <span class="co1">// --- Initialize variables ---</span>
        <span class="co1">//   tDataFromClient = new COM_DATA();</span>
        <span class="kw1">while</span> <span class="br0">(</span> tDataFromClient <span class="sy0">==</span> <span class="kw2">null</span> <span class="br0">)</span>
        <span class="br0">{</span>
           <span class="kw1">try</span> <span class="br0">{</span>
              <span class="co1">// --- Read Line Number first --</span>
              tDataFromClient <span class="sy0">=</span> <span class="br0">(</span>COM_DATA<span class="br0">)</span> oIn.<span class="me1">readObject</span><span class="br0">(</span><span class="br0">)</span><span class="sy0">;</span>
           <span class="br0">}</span> <span class="kw1">catch</span> <span class="br0">(</span> <span class="kw3">ClassNotFoundException</span> e <span class="br0">)</span> <span class="br0">{</span>
               <span class="kw3">System</span>.<span class="me1">out</span>.<span class="me1">println</span><span class="br0">(</span> <span class="st0">"ClassNotFound"</span> <span class="br0">)</span><span class="sy0">;</span>
           <span class="br0">}</span>
        <span class="br0">}</span>
        <span class="kw3">System</span>.<span class="me1">out</span>.<span class="me1">println</span><span class="br0">(</span> <span class="st0">"Get: "</span> <span class="sy0">+</span> tDataFromClient.<span class="me1">comData</span> <span class="br0">)</span><span class="sy0">;</span>
     <span class="kw1">return</span> tDataFromClient<span class="sy0">;</span>
    <span class="br0">}</span> <span class="co1">// --- getDataFromClient() Method --- </span>
    <span class="co3">/**
     * Send data to Client 
     */</span>
    <span class="kw1">private</span> <span class="kw1">static</span> <span class="kw4">void</span> <span class="st0">''</span><span class="st0">'sendDataToClient'</span><span class="st0">''</span><span class="br0">(</span> COM_DATA tDataToClient,
                                           <span class="kw3">ObjectOutputStream</span>  oOut <span class="br0">)</span> <span class="kw1">throws</span> <span class="kw3">IOException</span>
    <span class="br0">{</span>         
        <span class="kw3">System</span>.<span class="me1">out</span>.<span class="me1">println</span><span class="br0">(</span> <span class="st0">"Sent: "</span> <span class="sy0">+</span> tDataToClient.<span class="me1">comData</span> <span class="br0">)</span><span class="sy0">;</span>
        oOut.<span class="me1">writeObject</span><span class="br0">(</span> tDataToClient <span class="br0">)</span><span class="sy0">;</span>
      <span class="kw1">return</span><span class="sy0">;</span>
    <span class="br0">}</span> <span class="co1">// -- End of sendDataToClient() Method --</span>
 <span class="br0">}</span> <span class="co1">// --- End of ComServerThread class ---</span>
</pre></div>
</div>
<dl><dt>COM_DATA tDataFromClient&#160;</dt>
<dd>This variable will contain the data object from the client.</dd>
<dt>COM_DATA tDataToClient&#160;</dt>
<dd>This variable will contain the data object to be sent to the client.</dd>
<dt>sendDataToClient&#160;</dt>
<dd>This method sends the data object to the client.</dd>
<dt>getDataFromClient&#160;</dt>
<dd>This method gets the data object from the client.</dd>
<dt>processInput( tDataFromClient )&#160;</dt>
<dd>This method of the class 'ComProtocol' interprets the client commands and returns the data object that will be sent back to the client.</dd>
</dl><hr><h3> <span class="mw-headline" id="Handling_the_request.3B_implements_the_communication_protocol">Handling the request; implements the communication protocol</span></h3>
<dl><dt>ComProtocol&#160;</dt>
<dd>This class implements, and encapsulates the communication logic(protocol). The protocol is the following:
<ol><li>The client initiate the connection.</li>
<li>The server accepts it and sends an acknowledgment notifying that it's ready</li>
<li>The client sends a request</li>
<li>The server response based on the request</li>
</ol></dd>
<dd>...
<ol><li>The client sends a 'BYE' request</li>
<li>The server acknowledge the 'Bye' request and disconnects the socket connection</li>
<li>The client gets the acknowledgment to the 'BYE'</li>
</ol></dd>
<dd>...
<ol><li>The client sends a 'SHUTDOWN' request</li>
<li>The server acknowledge the 'SHUTDOWN' request and disconnects and also stops listening of other clients.</li>
<li>The client gets the acknowledgment to the 'SHUTDOWN'</li>
</ol></dd>
</dl><pre>
<code><a href="Keywords/class.html" title="Java Programming/Keywords/class"><font style="color:DodgerBlue4; text-decoration: none; font-weight: bold;">class</font></a></code> <b>ComProtocol</b>
{
 <code><a href="Keywords/private.html" title="Java Programming/Keywords/private"><font style="color:DodgerBlue4; text-decoration: none; font-weight: bold;">private</font></a></code> <code><a href="Keywords/static.html" title="Java Programming/Keywords/static"><font style="color:DodgerBlue4; text-decoration: none; font-weight: bold;">static</font></a></code> <code><a href="Keywords/final.html" title="Java Programming/Keywords/final"><font style="color:DodgerBlue4; text-decoration: none; font-weight: bold;">final</font></a></code> <code><a href="Keywords/int.html" title="Java Programming/Keywords/int"><font style="color:DodgerBlue4; text-decoration: none; font-weight: bold;">int</font></a></code> COM_STATUS_WAITING    = 0; 
 <code><a href="Keywords/private.html" title="Java Programming/Keywords/private"><font style="color:DodgerBlue4; text-decoration: none; font-weight: bold;">private</font></a></code> <code><a href="Keywords/static.html" title="Java Programming/Keywords/static"><font style="color:DodgerBlue4; text-decoration: none; font-weight: bold;">static</font></a></code> <code><a href="Keywords/final.html" title="Java Programming/Keywords/final"><font style="color:DodgerBlue4; text-decoration: none; font-weight: bold;">final</font></a></code> <code><a href="Keywords/int.html" title="Java Programming/Keywords/int"><font style="color:DodgerBlue4; text-decoration: none; font-weight: bold;">int</font></a></code> COM_STATUS_READY_SENT = 1;
 <code><a href="Keywords/private.html" title="Java Programming/Keywords/private"><font style="color:DodgerBlue4; text-decoration: none; font-weight: bold;">private</font></a></code> <code><a href="Keywords/static.html" title="Java Programming/Keywords/static"><font style="color:DodgerBlue4; text-decoration: none; font-weight: bold;">static</font></a></code> <code><a href="Keywords/final.html" title="Java Programming/Keywords/final"><font style="color:DodgerBlue4; text-decoration: none; font-weight: bold;">final</font></a></code> <code><a href="Keywords/int.html" title="Java Programming/Keywords/int"><font style="color:DodgerBlue4; text-decoration: none; font-weight: bold;">int</font></a></code> COM_STATUS_DATA_SENT  = 2;
 <code><a href="Keywords/private.html" title="Java Programming/Keywords/private"><font style="color:DodgerBlue4; text-decoration: none; font-weight: bold;">private</font></a></code> <code><a href="Keywords/static.html" title="Java Programming/Keywords/static"><font style="color:DodgerBlue4; text-decoration: none; font-weight: bold;">static</font></a></code> <code><a href="Keywords/final.html" title="Java Programming/Keywords/final"><font style="color:DodgerBlue4; text-decoration: none; font-weight: bold;">final</font></a></code> <code><a href="Keywords/int.html" title="Java Programming/Keywords/int"><font style="color:DodgerBlue4; text-decoration: none; font-weight: bold;">int</font></a></code> COM_STATUS_WAITING_FOR_TERMINALID = 3;
 <code><a href="Keywords/private.html" title="Java Programming/Keywords/private"><font style="color:DodgerBlue4; text-decoration: none; font-weight: bold;">private</font></a></code> <code><a href="Keywords/int.html" title="Java Programming/Keywords/int"><font style="color:DodgerBlue4; text-decoration: none; font-weight: bold;">int</font></a></code> state = COM_STATUS_WAITING;
 
 // --- Reference to 'BACK-END' module ---  
 private MqTeAccess mqTe;
 ...
   /**
    * Create a protokol object; CAll MQ INI function
    */
   <code><a href="Keywords/public.html" title="Java Programming/Keywords/public"><font style="color:DodgerBlue4; text-decoration: none; font-weight: bold;">public</font></a></code> ComProtocol()
   {
    <code><a href="Keywords/int.html" title="Java Programming/Keywords/int"><font style="color:DodgerBlue4; text-decoration: none; font-weight: bold;">int</font></a></code>    iRet = 0;
       // --- Initialize 'BACK-END' modules  ---
       mqTe. ...
...
   }
   /**
    * --- Process the Input and Create the output to the Client ---
    */
   <code><a href="Keywords/public.html" title="Java Programming/Keywords/public"><font style="color:DodgerBlue4; text-decoration: none; font-weight: bold;">public</font></a></code> COM_DATA processInput( COM_DATA theInput )
   {
    COM_DATA theOutput;
       // --- Initialize Variables ---
       theOutput = <code><a href="Keywords/new.html" title="Java Programming/Keywords/new"><font style="color:DodgerBlue4; text-decoration: none; font-weight: bold;">new</font></a></code> COM_DATA();
       // --- Check if the Clients want to disconnect ---
       <code><a href="Keywords/if.html" title="Java Programming/Keywords/if"><font style="color:DodgerBlue4; text-decoration: none; font-weight: bold;">if</font></a></code> ( theInput != null ) 
       {
           <code><a href="Keywords/if.html" title="Java Programming/Keywords/if"><font style="color:DodgerBlue4; text-decoration: none; font-weight: bold;">if</font></a></code> ( theInput.comData.equals(<b>"!BYE.@"</b>) )
           {
               // --- The Client wants to terminate; Echo data back to client
               theOutput.comData = "BYE.";
               // --- Mark the comunication to be terminated ---
               theOutput.bExit = true;
               // --- Set the internal state to wait for a new client ---
               state = COM_STATUS_WAITING;
               // --- Return Data object to be sent to the client ---
               return theOutput;
           }
           <code><a href="Keywords/if.html" title="Java Programming/Keywords/if"><font style="color:DodgerBlue4; text-decoration: none; font-weight: bold;">if</font></a></code> ( theInput.comData.equals(<b>"!SHUTDOWN.@"</b>) )
           {
               // --- The Client wants to terminate; Echo data back to client
               theOutput.comData = "BYE.";
               // --- Mark the comunication to be terminated ---
               theOutput.bExit = true;
               // --- Tell the server to stop listening for new clients ---
               ComServer.GL_listening = false;
               // --- Set the internal state to wait for a new client ---
               state = COM_STATUS_WAITING;
               // --- Return Data object to be sent to the client ---
               return theOutput;
           }
       }
       <code><a href="Keywords/if.html" title="Java Programming/Keywords/if"><font style="color:DodgerBlue4; text-decoration: none; font-weight: bold;">if</font></a></code> ( state == COM_STATUS_WAITING )
       {
           // --- Send ready Message to the Client ---
           theOutput.comData = "Ready:";
           // --- Set the internal state ready; and wait for TerminalId ---
           state = COM_STATUS_WAITING_FOR_TERMINALID;
       }
       <code><a href="Keywords/else.html" title="Java Programming/Keywords/else"><font style="color:DodgerBlue4; text-decoration: none; font-weight: bold;">else</font></a></code> <code><a href="Keywords/if.html" title="Java Programming/Keywords/if"><font style="color:DodgerBlue4; text-decoration: none; font-weight: bold;">if</font></a></code> ( state == COM_STATUS_WAITING_FOR_TERMINALID )
       {
        <code><a href="Keywords/int.html" title="Java Programming/Keywords/int"><font style="color:DodgerBlue4; text-decoration: none; font-weight: bold;">int</font></a></code> iRet;
           // --- Get the Terminal ID ---
           sTermId = theInput.comData; 
           // --- Call 'BACK-END' modules ...  ---
           mqTe. ...
...
           // --- Send ready Message with the Server Version to the Client ---
           theOutput.comData = "Ready;Server Version 1.0:";
           // --- Set the internal state raedy; and wait for TerminalId ---
           state = COM_STATUS_READY_SENT;
       }
       <code><a href="Keywords/else.html" title="Java Programming/Keywords/else"><font style="color:DodgerBlue4; text-decoration: none; font-weight: bold;">else</font></a></code> <code><a href="Keywords/if.html" title="Java Programming/Keywords/if"><font style="color:DodgerBlue4; text-decoration: none; font-weight: bold;">if</font></a></code> ( state == COM_STATUS_READY_SENT )
       {
        <code><a href="Keywords/int.html" title="Java Programming/Keywords/int"><font style="color:DodgerBlue4; text-decoration: none; font-weight: bold;">int</font></a></code> iRet;
           String sCommand = theInput.comData;
           // --- Call 'BACK-END' modules ...
...
           /*
           ** --- Check if we should get Response data ---
           */
           <code><a href="Keywords/if.html" title="Java Programming/Keywords/if"><font style="color:DodgerBlue4; text-decoration: none; font-weight: bold;">if</font></a></code> ( theInput.iRet == COM_DATA.NOWAIT_FOR_RESPONSE ) {
               // -- Set the Output Value ---
               theOutput.iRet = iRet;
               theOutput.comData = "";
           }
           <code><a href="Keywords/else.html" title="Java Programming/Keywords/else"><font style="color:DodgerBlue4; text-decoration: none; font-weight: bold;">else</font></a></code> {
               // --- Call 'BACK-END' modules ---
               mqTe. ...
               // --- Set the Output Value ---
               theOutput.comData    = mqTe.sResponseBuffer; 
               theOutput.iRet       = iRet;
           }
       }
    <code><a href="Keywords/return.html" title="Java Programming/Keywords/return"><font style="color:DodgerBlue4; text-decoration: none; font-weight: bold;">return</font></a></code> theOutput;
   }  // --- End of Method processInput() ---
} // --- End of ComProtocol Class Definition ---
</pre>
<hr><h3> <span class="mw-headline" id="The_Data_object_that_goes_through_the_network">The Data object that goes through the network</span></h3>
<dl><dt>COM_DATA&#160;</dt>
<dd>is data structure class that is transmitted through the network. The class contains only data.</dd>
</dl><pre>
/**
 * COM_DATA data structure 
 */
<code><a href="Keywords/public.html" title="Java Programming/Keywords/public"><font style="color:DodgerBlue4; text-decoration: none; font-weight: bold;">public</font></a></code> <code><a href="Keywords/class.html" title="Java Programming/Keywords/class"><font style="color:DodgerBlue4; text-decoration: none; font-weight: bold;">class</font></a></code> COM_DATA <code><a href="Keywords/implements.html" title="Java Programming/Keywords/implements"><font style="color:DodgerBlue4; text-decoration: none; font-weight: bold;">implements</font></a></code> Serializable
{
 <code><a href="Keywords/public.html" title="Java Programming/Keywords/public"><font style="color:DodgerBlue4; text-decoration: none; font-weight: bold;">public</font></a></code> <code><a href="API/java.lang.String.html" title="Java Programming/API/java.lang.String">String</a></code>  comData;
 <code><a href="Keywords/public.html" title="Java Programming/Keywords/public"><font style="color:DodgerBlue4; text-decoration: none; font-weight: bold;">public</font></a></code> <code><a href="Keywords/boolean.html" title="Java Programming/Keywords/boolean"><font style="color:DodgerBlue4; text-decoration: none; font-weight: bold;">boolean</font></a></code> bExit;
 <code><a href="Keywords/public.html" title="Java Programming/Keywords/public"><font style="color:DodgerBlue4; text-decoration: none; font-weight: bold;">public</font></a></code> <code><a href="Keywords/int.html" title="Java Programming/Keywords/int"><font style="color:DodgerBlue4; text-decoration: none; font-weight: bold;">int</font></a></code>     iRet;
   /**
    * --- Contants values can be passed in in iRet to the Server ---
    */
   <code><a href="Keywords/static.html" title="Java Programming/Keywords/static"><font style="color:DodgerBlue4; text-decoration: none; font-weight: bold;">static</font></a></code> <code><a href="Keywords/final.html" title="Java Programming/Keywords/final"><font style="color:DodgerBlue4; text-decoration: none; font-weight: bold;">final</font></a></code> <code><a href="Keywords/int.html" title="Java Programming/Keywords/int"><font style="color:DodgerBlue4; text-decoration: none; font-weight: bold;">int</font></a></code> WAIT_FOR_RESPONSE    = 0;
   <code><a href="Keywords/static.html" title="Java Programming/Keywords/static"><font style="color:DodgerBlue4; text-decoration: none; font-weight: bold;">static</font></a></code> <code><a href="Keywords/final.html" title="Java Programming/Keywords/final"><font style="color:DodgerBlue4; text-decoration: none; font-weight: bold;">final</font></a></code> <code><a href="Keywords/int.html" title="Java Programming/Keywords/int"><font style="color:DodgerBlue4; text-decoration: none; font-weight: bold;">int</font></a></code> NOWAIT_FOR_RESPONSE  = 1;
  /**
   * Initialize the data structure
   */
  <code><a href="Keywords/public.html" title="Java Programming/Keywords/public"><font style="color:DodgerBlue4; text-decoration: none; font-weight: bold;">public</font></a></code> COM_DATA()
  {
     comData     = "";
     bExit       = false;
     iRet        = 0;
  } // -- End of COM_DATA() Constructor --   
  /**
   * Copy over it contents 
   */
  <code><a href="Keywords/public.html" title="Java Programming/Keywords/public"><font style="color:DodgerBlue4; text-decoration: none; font-weight: bold;">public</font></a></code> <code><a href="Keywords/void.html" title="Java Programming/Keywords/void"><font style="color:DodgerBlue4; text-decoration: none; font-weight: bold;">void</font></a></code> copy( COM_DATA tSrc )
  {
     <code><a href="Keywords/this.html" title="Java Programming/Keywords/this"><font style="color:DodgerBlue4; text-decoration: none; font-weight: bold;">this</font></a></code>.comData     = tSrc.comData;
     <code><a href="Keywords/this.html" title="Java Programming/Keywords/this"><font style="color:DodgerBlue4; text-decoration: none; font-weight: bold;">this</font></a></code>.bExit       = tSrc.bExit;
     <code><a href="Keywords/this.html" title="Java Programming/Keywords/this"><font style="color:DodgerBlue4; text-decoration: none; font-weight: bold;">this</font></a></code>.iRet        = tSrc.iRet;
   <code><a href="Keywords/return.html" title="Java Programming/Keywords/return"><font style="color:DodgerBlue4; text-decoration: none; font-weight: bold;">return</font></a></code>;
  } 
} // -- End of COM_DATA class --
</pre>
<h2> <span class="mw-headline" id="Create_the_Client">Create the Client</span></h2>
<p>A client code for a server/service is usually an API that a user application uses to interface to the server. With the help of a client API the user application does not have to know how to connect to the server to get services.</p>
<dl><dt>ComClient&#160;</dt>
<dd>This class is the client API. The application is using this class to communicate with the server.</dd>
</dl><p>The following is the client class for the above server:</p>
<pre>
<code><a href="Keywords/public.html" title="Java Programming/Keywords/public"><font style="color:DodgerBlue4; text-decoration: none; font-weight: bold;">public</font></a></code> <code><a href="Keywords/class.html" title="Java Programming/Keywords/class"><font style="color:DodgerBlue4; text-decoration: none; font-weight: bold;">class</font></a></code> <b>ComClient</b>
{
 <code><a href="Keywords/private.html" title="Java Programming/Keywords/private"><font style="color:DodgerBlue4; text-decoration: none; font-weight: bold;">private</font></a></code> Socket         comSocket;
 <code><a href="Keywords/private.html" title="Java Programming/Keywords/private"><font style="color:DodgerBlue4; text-decoration: none; font-weight: bold;">private</font></a></code> ObjectOutputStream oOut;
 <code><a href="Keywords/private.html" title="Java Programming/Keywords/private"><font style="color:DodgerBlue4; text-decoration: none; font-weight: bold;">private</font></a></code> ObjectInputStream  oIn;
 <code><a href="Keywords/private.html" title="Java Programming/Keywords/private"><font style="color:DodgerBlue4; text-decoration: none; font-weight: bold;">private</font></a></code> <code><a href="Keywords/boolean.html" title="Java Programming/Keywords/boolean"><font style="color:DodgerBlue4; text-decoration: none; font-weight: bold;">boolean</font></a></code>         IsItOpen = false;       
   /**
    * --- Open Socket ---
    */
   <code><a href="Keywords/public.html" title="Java Programming/Keywords/public"><font style="color:DodgerBlue4; text-decoration: none; font-weight: bold;">public</font></a></code> <code><a href="Keywords/void.html" title="Java Programming/Keywords/void"><font style="color:DodgerBlue4; text-decoration: none; font-weight: bold;">void</font></a></code> openCom( <code><a href="API/java.lang.String.html" title="Java Programming/API/java.lang.String">String</a></code> sServerName,
                        <code><a href="Keywords/int.html" title="Java Programming/Keywords/int"><font style="color:DodgerBlue4; text-decoration: none; font-weight: bold;">int</font></a></code>    iPortNumber ) <code><a href="Keywords/throws.html" title="Java Programming/Keywords/throws"><font style="color:DodgerBlue4; text-decoration: none; font-weight: bold;">throws</font></a></code> UnknownHostException,
                                                             IOException  
   {
      <code><a href="Keywords/try.html" title="Java Programming/Keywords/try"><font style="color:DodgerBlue4; text-decoration: none; font-weight: bold;">try</font></a></code> {
         // --- Open Socket for communication ---
         comSocket = <code><a href="Keywords/new.html" title="Java Programming/Keywords/new"><font style="color:DodgerBlue4; text-decoration: none; font-weight: bold;">new</font></a></code> Socket( sServerName, iPortNumber );     
         // --- Get Stream to write request to the Server ---
         oOut = <code><a href="Keywords/new.html" title="Java Programming/Keywords/new"><font style="color:DodgerBlue4; text-decoration: none; font-weight: bold;">new</font></a></code> ObjectOutputStream( comSocket.getOutputStream() );     
         // --- Get Stream// to read from the Server
         oIn = <code><a href="Keywords/new.html" title="Java Programming/Keywords/new"><font style="color:DodgerBlue4; text-decoration: none; font-weight: bold;">new</font></a></code> ObjectInputStream( comSocket.getInputStream());
         // --- Set internal Member variable that the Communication opened ---
         IsItOpen = <code><a href="Literals/Boolean_Literals/true.html" title="Java Programming/Literals/Boolean Literals/true"><font style="color:DodgerBlue4; text-decoration: none; font-weight: bold;">true</font></a></code>;
      } <code><a href="Keywords/catch.html" title="Java Programming/Keywords/catch"><font style="color:DodgerBlue4; text-decoration: none; font-weight: bold;">catch</font></a></code> ( java.net.UnknownHostException e ) {
         System.err.println( "(openCom:)Don't know about host: "+sServerName );
         IsItOpen = <code><a href="Literals/Boolean_Literals/false.html" title="Java Programming/Literals/Boolean Literals/false"><font style="color:DodgerBlue4; text-decoration: none; font-weight: bold;">false</font></a></code>;
         throw( e );                                         
      } <code><a href="Keywords/catch.html" title="Java Programming/Keywords/catch"><font style="color:DodgerBlue4; text-decoration: none; font-weight: bold;">catch</font></a></code> ( java.io.IOException e ) {
         System.err.println("(openCom:)Couldn't get I/O for the connection to: "+ sServerName );
         IsItOpen = <code><a href="Literals/Boolean_Literals/false.html" title="Java Programming/Literals/Boolean Literals/false"><font style="color:DodgerBlue4; text-decoration: none; font-weight: bold;">false</font></a></code>;
         <code><a href="Keywords/throw.html" title="Java Programming/Keywords/throw"><font style="color:DodgerBlue4; text-decoration: none; font-weight: bold;">throw</font></a></code>( e );         
      }               
   }
   /**
    * --- Check if Socket is open ---
    */
   <code><a href="Keywords/public.html" title="Java Programming/Keywords/public"><font style="color:DodgerBlue4; text-decoration: none; font-weight: bold;">public</font></a></code> <code><a href="Keywords/boolean.html" title="Java Programming/Keywords/boolean"><font style="color:DodgerBlue4; text-decoration: none; font-weight: bold;">boolean</font></a></code> isItOpen()
   {
     <code><a href="Keywords/return.html" title="Java Programming/Keywords/return"><font style="color:DodgerBlue4; text-decoration: none; font-weight: bold;">return</font></a></code> IsItOpen;
   }     
   /**
    * --- Get data string from the Server ---
    */
   <code><a href="Keywords/public.html" title="Java Programming/Keywords/public"><font style="color:DodgerBlue4; text-decoration: none; font-weight: bold;">public</font></a></code> <code><a href="Keywords/void.html" title="Java Programming/Keywords/void"><font style="color:DodgerBlue4; text-decoration: none; font-weight: bold;">void</font></a></code> <b>getServerData( COM_DATA tServData )</b> throws IOException
   {
       // --- Initialize Variables ---
       tServData.comData = "";
       // --- Get the Response from the Server ---              
       <code><a href="Keywords/try.html" title="Java Programming/Keywords/try"><font style="color:DodgerBlue4; text-decoration: none; font-weight: bold;">try</font></a></code> {
          tServData.copy( (COM_DATA) <b>oIn.readObject()</b> );
       }   
       <code><a href="Keywords/catch.html" title="Java Programming/Keywords/catch"><font style="color:DodgerBlue4; text-decoration: none; font-weight: bold;">catch</font></a></code> ( ClassNotFoundException e ) {
           System.out.println( "Class Not Found" );
       } 
       System.out.println( "Server: " + tServData.comData );
       <code><a href="Keywords/if.html" title="Java Programming/Keywords/if"><font style="color:DodgerBlue4; text-decoration: none; font-weight: bold;">if</font></a></code> ( tServData.comData.equals(<b>"BYE."</b>) )
       {
           tServData.bExit = <code><a href="Literals/Boolean_Literals/true.html" title="Java Programming/Literals/Boolean Literals/true"><font style="color:DodgerBlue4; text-decoration: none; font-weight: bold;">true</font></a></code>;
       }        
    <code><a href="Keywords/return.html" title="Java Programming/Keywords/return"><font style="color:DodgerBlue4; text-decoration: none; font-weight: bold;">return</font></a></code>;
   }
   /**
    * --- Send data to the Server ---
    */
   <code><a href="Keywords/public.html" title="Java Programming/Keywords/public"><font style="color:DodgerBlue4; text-decoration: none; font-weight: bold;">public</font></a></code> <code><a href="Keywords/void.html" title="Java Programming/Keywords/void"><font style="color:DodgerBlue4; text-decoration: none; font-weight: bold;">void</font></a></code> <b>sendDataToServer( COM_DATA tServData )</b> <code><a href="Keywords/throws.html" title="Java Programming/Keywords/throws"><font style="color:DodgerBlue4; text-decoration: none; font-weight: bold;">throws</font></a></code> IOException
   {
       // --- Send the data string ---
       System.out.println( "Send: " + tServData.comData );
       <b>oOut.writeObject( tServData )</b>;
    <code><a href="Keywords/return.html" title="Java Programming/Keywords/return"><font style="color:DodgerBlue4; text-decoration: none; font-weight: bold;">return</font></a></code>;
   } 
   /**
    * --- Close Socket --- 
    */
   <code><a href="Keywords/public.html" title="Java Programming/Keywords/public"><font style="color:DodgerBlue4; text-decoration: none; font-weight: bold;">public</font></a></code> <code><a href="Keywords/void.html" title="Java Programming/Keywords/void"><font style="color:DodgerBlue4; text-decoration: none; font-weight: bold;">void</font></a></code> closeCom() <code><a href="Keywords/throws.html" title="Java Programming/Keywords/throws"><font style="color:DodgerBlue4; text-decoration: none; font-weight: bold;">throws</font></a></code> IOException
   {
       oOut.close();
       oIn.close();
       comSocket.close();     
       IsItOpen = <code><a href="Literals/Boolean_Literals/false.html" title="Java Programming/Literals/Boolean Literals/false"><font style="color:DodgerBlue4; text-decoration: none; font-weight: bold;">false</font></a></code>;
   }    
}
</pre>
<dl><dt>getServerData( COM_DATA tServData )&#160;</dt>
<dd>This method reads the data from the server and copies the values to 'tServData' object.</dd>
<dt>sendDataToServer( COM_DATA tServData )&#160;</dt>
<dd>This method sends the 'tServData' object through the network ro the server.</dd>
<dt>oIn.readObject()&#160;</dt>
<dd>This method returns the data object sent by the server.</dd>
<dt>oOut.writeObject( tServData )&#160;</dt>
<dd>This method sends the data object to the server.</dd>
</dl></div>				
								
				
				
												
								
												
				
				
								<div class="visualClear"></div>
				
								
			</div>
			</div></body></html>