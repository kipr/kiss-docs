<html><head><title>Java Programming/Reflection/Overview</title><link media="all" href="../../../misc/modern.css" type="text/css" rel="stylesheet"></head><body class="mediawiki"><div id="content"><h1 class="firstHeading" id="firstHeading">Java Programming/Reflection/Overview</h1><div id="bodyContent">
								
				
				
								
				
				
																
				
				
								
				<div lang="en" dir="ltr" class="mw-content-ltr"><table class="wikitable" style="float: right;"><tr><td>Navigate <b><a href="../Reflection.html" title="Java Programming/Reflection">Reflection</a></b> topic:
<ul><li> <strong class="selflink">Reflection Overview</strong></li>
<li> <a href="Dynamic_Class_Loading.html" title="Java Programming/Reflection/Dynamic Class Loading">Dynamic Class Loading</a></li>
<li> <a href="Dynamic_Invocation.html" title="Java Programming/Reflection/Dynamic Invocation">Dynamic Method Invocation</a></li>
<li> <a href="Accessing_Private_Features_with_Reflection.html" title="Java Programming/Reflection/Accessing Private Features with Reflection">Accessing Private Features with Reflection</a></li>
</ul></td>
</tr></table><p>Reflection is the mechanism by which Java exposes the features of a class during runtime, allowing Java programs to enumerate and access a class' methods, fields, and constructors as objects. In other words, there are object based <i>mirrors</i> which reflect the Java object model, and you can use these objects to access an object's features using runtime API constructs instead of compile time language constructs.</p>
<p>Each object instance has a <code>getClass()</code> method, inherited from <code><a href="http://en.wikibooks.org/w/index.php?title=Category:Java_Programming/API/java.lang&amp;action=edit&amp;redlink=1" class="new" title="Category:Java Programming/API/java.lang (does not exist)">java.lang</a>.<a href="../API/java.lang.Object.html" title="Java Programming/API/java.lang.Object">Object</a></code>, which returns an object with the runtime representation of that object's class; this object is an instance of the <code><a href="http://en.wikibooks.org/w/index.php?title=Category:Java_Programming/API/java.lang&amp;action=edit&amp;redlink=1" class="new" title="Category:Java Programming/API/java.lang (does not exist)">java.lang</a>.<a href="../API/java.lang.Class.html" title="Java Programming/API/java.lang.Class">Class</a></code> This object in turn has methods which return the fields, methods, constructors, superclass, and other properties of that class.</p>
<p>You can use these reflection objects to access fields, invoke methods, or instantiate instances, all without having compile time dependencies on those features. The Java runtime provides the corresponding classes for reflection. Most of the Java classes which support reflection are in the java.lang.reflect package.</p>
<p>Reflection is most useful for performing dynamic operations with Java - operations which are not hard coded into a source program but which are determined at run time. One of the most important aspects of reflection is <a href="Dynamic_Class_Loading.html" title="Java Programming/Reflection/Dynamic Class Loading">dynamic class loading</a>.</p>
<h2> <span class="mw-headline" id="Example:_Invoking_a_main_method">Example: Invoking a main method</span></h2>
<p>One way to understand how reflection works is to use reflection to model how the Java Runtime Environment (JRE) loads and executes a class. When you invoke a Java program</p>
<pre>
java <i>fully-qualified-class-name</i> <i>arg<sub>0</sub> ... arg<sub>n</sub></i>
</pre>
<p>and pass it command line arguments, the JRE must</p>
<ol><li>put the command line arguments <i>arg<sub>0</sub> ... arg<sub>n</sub></i> into a <code><a href="../API/java.lang.String.html" title="Java Programming/API/java.lang.String">String</a></code>[] array</li>
<li>dynamically load the target class named by <i>fully-qualified-class-name</i></li>
<li>access the <code><a href="../Keywords/public.html" title="Java Programming/Keywords/public"><font style="color:DodgerBlue4; text-decoration: none; font-weight: bold;">public</font></a></code> <code><a href="../Keywords/static.html" title="Java Programming/Keywords/static"><font style="color:DodgerBlue4; text-decoration: none; font-weight: bold;">static</font></a></code> <code><a href="../Keywords/void.html" title="Java Programming/Keywords/void"><font style="color:DodgerBlue4; text-decoration: none; font-weight: bold;">void</font></a></code> <code>main(String[])</code> method</li>
<li>invoke the main method, passing the String[] array.</li>
</ol><p>Steps 2, 3, and 4 can be accomplished with Java reflection.</p>
<p>Below is an example of loading the Distance class, locating the main method, (see <a href="../Understanding_a_Java_Program.html" title="Java Programming/Understanding a Java Program">Understanding a Java Program</a>) and invoking it via reflection.</p>
<table style="padding:2px; margin:2px; width:100%;"><tr valign="top"><td style="width:32px;"><img alt="Computer code" src="../../../thumbs/0a23a_32px-Nuvola_apps_display.png" width="32" height="32"></td>
<td style="background-color:#f0f0ff; border-left: 4px solid blue; padding-left: 6px; font-family: Monaco, Consolas, 'Courier New', Courier; font-size:1.0em; line-height:1.5 !important;">
<div dir="ltr" class="mw-geshi" style="text-align: left;">
<div class="java source-java"><span class="kw1">public</span> <span class="kw1">static</span> <span class="kw4">void</span> invokeMain<span class="br0">(</span><span class="br0">)</span><br>
&#160; &#160;<span class="kw1">throws</span> <span class="kw3">ClassNotFoundException</span>,<br>
&#160; &#160; &#160; &#160; <span class="kw3">SecurityException</span>,<br>
&#160; &#160; &#160; &#160; <span class="kw3">NoSuchMethodException</span>,<br>
&#160; &#160; &#160; &#160; <span class="kw3">IllegalArgumentException</span>,<br>
&#160; &#160; &#160; &#160; <span class="kw3">IllegalAccessException</span>,<br>
&#160; &#160; &#160; &#160; <span class="kw3">InvocationTargetException</span>,<br>
&#160; &#160; &#160;<span class="kw3">ExceptionInInitializerError</span><br><span class="br0">{</span><br>
&#160; &#160;Class<span class="sy0">&lt;?&gt;</span> distanceClass <span class="sy0">=</span> <span class="kw1">Class</span>.<span class="me1">forName</span><span class="br0">(</span><span class="st0">"Distance"</span><span class="br0">)</span><span class="sy0">;</span><br>
&#160; &#160;<span class="kw3">String</span><span class="br0">[</span><span class="br0">]</span> points <span class="sy0">=</span> <span class="br0">{</span><span class="st0">"0"</span>,<span class="st0">"0"</span>,<span class="st0">"3"</span>,<span class="st0">"4"</span><span class="br0">}</span><span class="sy0">;</span><br>
&#160; &#160;<span class="kw3">Method</span> mainMethod <span class="sy0">=</span> distanceClass.<span class="me1">getMethod</span><span class="br0">(</span><span class="st0">"main"</span>,<span class="kw3">String</span><span class="br0">[</span><span class="br0">]</span>.<span class="kw1">class</span><span class="br0">)</span><span class="sy0">;</span><br>
&#160; &#160;<span class="kw3">Object</span> result <span class="sy0">=</span> mainMethod.<span class="me1">invoke</span><span class="br0">(</span><span class="kw2">null</span>, <span class="br0">(</span><span class="kw3">Object</span><span class="br0">)</span> points<span class="br0">)</span><span class="sy0">;</span><br><span class="br0">}</span></div>
</div>
</td>
</tr></table><p>This code is obviously more complicated than simply calling</p>
<table style="padding:2px; margin:2px; width:100%;"><tr valign="top"><td style="width:32px;"><img alt="Computer code" src="../../../thumbs/0a23a_32px-Nuvola_apps_display.png" width="32" height="32"></td>
<td style="background-color:#f0f0ff; border-left: 4px solid blue; padding-left: 6px; font-family: Monaco, Consolas, 'Courier New', Courier; font-size:1.0em; line-height:1.5 !important;">
<div dir="ltr" class="mw-geshi" style="text-align: left;">
<div class="java source-java">Distance.<span class="me1">main</span><span class="br0">(</span><span class="kw1">new</span> <span class="kw3">String</span><span class="br0">[</span><span class="br0">]</span><span class="br0">{</span><span class="st0">"0"</span>,<span class="st0">"0"</span>,<span class="st0">"3"</span>,<span class="st0">"4"</span><span class="br0">}</span><span class="br0">)</span><span class="sy0">;</span></div>
</div>
</td>
</tr></table><p>However, the main java runtime does not know about the Distance class. The name of the class to execute is a runtime value. Reflection allows a Java program to work with classes even though the classes are not known when the program was written.</p>
<p>Let's explore what the invokeMain method is doing.</p>
<p>The first statement</p>
<pre>
<code><a href="../API/java.lang.Class.html" title="Java Programming/API/java.lang.Class">Class</a></code>&lt;?&gt; distanceClass = <code><a href="../API/java.lang.Class.html" title="Java Programming/API/java.lang.Class">Class</a></code>.forName(<code><font style="color:DarkGreen; text-decoration: none; font-weight: bold;">"Distance"</font></code>);
</pre>
<p>is an example of <a href="Dynamic_Class_Loading.html" title="Java Programming/Reflection/Dynamic Class Loading">dynamic class loading</a>. The <code>forName()</code> method will load a Java class and return an instance of <code><a href="http://en.wikibooks.org/w/index.php?title=Category:Java_Programming/API/java.lang&amp;action=edit&amp;redlink=1" class="new" title="Category:Java Programming/API/java.lang (does not exist)">java.lang</a>.<a href="../API/java.lang.Class.html" title="Java Programming/API/java.lang.Class">Class</a></code> that results from loading the class. In this case, we are loading the class <code><font style="color:DarkGreen; text-decoration: none; font-weight: bold;">"Distance"</font></code> from the default package. We store the class object in the local variable <code>distanceClass</code>; its type is <code><a href="../API/java.lang.Class.html" title="Java Programming/API/java.lang.Class">Class</a></code>&lt;?&gt;.</p>
<p>The second statement simply creates a <code><a href="../API/java.lang.String.html" title="Java Programming/API/java.lang.String">String</a></code> array with the four command line arguments we wish to pass to the main method of the Distance class.</p>
<p>The third statement</p>
<pre>
Method mainMethod = distanceClass.getMethod("main",String[].class);
</pre>
<p>performs a reflection operation on the Distance class. The <code>getMethod()</code> method is defined for the <code><a href="../API/java.lang.Class.html" title="Java Programming/API/java.lang.Class">Class</a></code> class. It takes a variable number of parameters: the method name is the first parameter and the remaining parameters are the types of each of main's paraemters. The method name is trivial: we want to invoke the <code>main</code> method, so we pass in the name <code><font style="color:DarkGreen; text-decoration: none; font-weight: bold;">"main"</font></code>. We then add a Class variable for each of the method parameters. <code>main</code> accepts one parameter, <code><code><a href="../API/java.lang.String.html" title="Java Programming/API/java.lang.String">String</a></code>[] args)</code> so we add a single Class element representing the String[]. The <code>getMethod</code> method has a return type of <code>java.lang.reflect.Method</code>; we store the result in a local variable named <code>mainMethod</code>.</p>
<p>Finally, we invoke the method by calling the <code>invoke()</code> method of the <code>Method</code> instance. This method's first parameter is the instance to invoke on, and the remaining parameters are for the invokee's parameters. Since we are invoking a static method and not an instance method, we pass <code><a href="../Literals/null.html" title="Java Programming/Literals/null"><font style="color:DodgerBlue4; text-decoration: none; font-weight: bold;">null</font></a></code> as the instance argument. Since we only have a single parameter we pass it as the second argument. However, we must cast the parameter to Object to indicate that the array is the parameter, and not that the parameters are in the array. See varargs for more details on this.</p>
<pre>
<code><a href="../API/java.lang.Object.html" title="Java Programming/API/java.lang.Object">Object</a></code> result = mainMethod.invoke(<code><a href="../Literals/null.html" title="Java Programming/Literals/null"><font style="color:DodgerBlue4; text-decoration: none; font-weight: bold;">null</font></a></code>, arguments);
</pre>
<p>The <code>invoke()</code> method returns an Object which will contain the result that the reflected method returns. In this case, our <code>main</code> method is a <code><a href="../Keywords/void.html" title="Java Programming/Keywords/void"><font style="color:DodgerBlue4; text-decoration: none; font-weight: bold;">void</font></a></code> method, so we ignore the return type.</p>
<p>Most of the methods in this short <code>invokeMain</code> method may throw various exceptions. The method declares all of them in its signatures. Here is a brief rundown of what might throw an exception:</p>
<ul><li>Class.forName(String) will throw ClassNotFoundException if the named class cannot be located.</li>
<li>Class.forName(String) will throw ExceptionInInitializerError if the class could not be loaded due the static initializer throwing an exception or a static field's initialization throwing an exception.</li>
<li>Class.getMethod(String name, Class parameterTypes[]) will throw
<ul><li>NoSuchMethodException if a matching method is not found, or is not public (use getDeclaredMethod to get a non-public method).</li>
<li>SecurityException if a security manager is installed and calling the method would result in an access violation (for example, the method is in the sun.* package designed for internal use only).</li>
</ul></li>
<li>Method.invoke(Object instance, Object... arguments) may throw:
<ul><li>IllegalAccessException if this method is invoked in a manner that violates its access modifiers.</li>
<li>IllegalArgumentException for various reasons, including
<ul><li>passing an instance that does not implement this method.</li>
<li>the actual arguments do not match the Method's arguments</li>
</ul></li>
<li>InvocationTargetException if the underlying method (main in this case) throws an exception.</li>
</ul></li>
</ul><p>In addition to these exceptions, there are also Errors and RuntimeExceptions that these methods may throw.</p>





</div>				
								
				
				
												
								
												
				
				
								<div class="visualClear"></div>
				
								
			</div>
			</div></body></html>