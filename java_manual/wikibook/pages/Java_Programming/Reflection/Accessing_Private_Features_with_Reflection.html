<html><head><title>Java Programming/Reflection/Accessing Private Features with Reflection</title><link media="all" href="../../../misc/modern.css" type="text/css" rel="stylesheet"></head><body class="mediawiki"><div id="content"><h1 class="firstHeading" id="firstHeading">Java Programming/Reflection/Accessing Private Features with Reflection</h1><div id="bodyContent">
								
				
				
								
				
				
																
				
				
								
				<div lang="en" dir="ltr" class="mw-content-ltr"><table class="wikitable" style="float: right;"><tr><td>Navigate <b><a href="../Reflection.html" title="Java Programming/Reflection">Reflection</a></b> topic:
<ul><li> <a href="Overview.html" title="Java Programming/Reflection/Overview">Reflection Overview</a></li>
<li> <a href="Dynamic_Class_Loading.html" title="Java Programming/Reflection/Dynamic Class Loading">Dynamic Class Loading</a></li>
<li> <a href="Dynamic_Invocation.html" title="Java Programming/Reflection/Dynamic Invocation">Dynamic Method Invocation</a></li>
<li> <strong class="selflink">Accessing Private Features with Reflection</strong></li>
</ul></td>
</tr></table><p>All features of a class can be obtained via reflection, including access to <code><a href="../Keywords/private.html" title="Java Programming/Keywords/private"><font style="color:DodgerBlue4; text-decoration: none; font-weight: bold;">private</font></a></code> methods &amp; variables. But not always see <a rel="nofollow" class="external autonumber" href="http://www.onjava.com/pub/a/onjava/2003/11/12/reflection.html">[1]</a></p>
<p>Let us look at the following example, Secret.java:</p>
<pre>
<code><a href="../Keywords/public.html" title="Java Programming/Keywords/public"><font style="color:DodgerBlue4; text-decoration: none; font-weight: bold;">public</font></a></code> <code><a href="../Keywords/class.html" title="Java Programming/Keywords/class"><font style="color:DodgerBlue4; text-decoration: none; font-weight: bold;">class</font></a></code> Secret {

  <code><a href="../Keywords/private.html" title="Java Programming/Keywords/private"><font style="color:DodgerBlue4; text-decoration: none; font-weight: bold;">private</font></a></code> <code><a href="../API/java.lang.String.html" title="Java Programming/API/java.lang.String">String</a></code> secretCode = <code><font style="color:DarkGreen; text-decoration: none; font-weight: bold;">"It's a secret"</font></code>;

  <code><a href="../Keywords/private.html" title="Java Programming/Keywords/private"><font style="color:DodgerBlue4; text-decoration: none; font-weight: bold;">private</font></a></code> <code><a href="../API/java.lang.String.html" title="Java Programming/API/java.lang.String">String</a></code> getSecretCode(){
    <code><a href="../Keywords/return.html" title="Java Programming/Keywords/return"><font style="color:DodgerBlue4; text-decoration: none; font-weight: bold;">return</font></a></code> secretCode;     
  }
}
</pre>
<p>Although the field and method are marked <code><a href="../Keywords/private.html" title="Java Programming/Keywords/private"><font style="color:DodgerBlue4; text-decoration: none; font-weight: bold;">private</font></a></code>, the following class shows that it is possible to access the <code><a href="../Keywords/private.html" title="Java Programming/Keywords/private"><font style="color:DodgerBlue4; text-decoration: none; font-weight: bold;">private</font></a></code> features of a class:</p>
<pre>
<code><a href="../Keywords/import.html" title="Java Programming/Keywords/import"><font style="color:DodgerBlue4; text-decoration: none; font-weight: bold;">import</font></a></code> java.lang.reflect.Field; 
<code><a href="../Keywords/import.html" title="Java Programming/Keywords/import"><font style="color:DodgerBlue4; text-decoration: none; font-weight: bold;">import</font></a></code> java.lang.reflect.Method; 

<code><a href="../Keywords/public.html" title="Java Programming/Keywords/public"><font style="color:DodgerBlue4; text-decoration: none; font-weight: bold;">public</font></a></code> <code><a href="../Keywords/class.html" title="Java Programming/Keywords/class"><font style="color:DodgerBlue4; text-decoration: none; font-weight: bold;">class</font></a></code> Hacker {
 
  <code><a href="../Keywords/private.html" title="Java Programming/Keywords/private"><font style="color:DodgerBlue4; text-decoration: none; font-weight: bold;">private</font></a></code> <code><a href="../Keywords/static.html" title="Java Programming/Keywords/static"><font style="color:DodgerBlue4; text-decoration: none; font-weight: bold;">static</font></a></code> <code><a href="../Keywords/final.html" title="Java Programming/Keywords/final"><font style="color:DodgerBlue4; text-decoration: none; font-weight: bold;">final</font></a></code> Object[] EMPTY = {};

  <code><a href="../Keywords/public.html" title="Java Programming/Keywords/public"><font style="color:DodgerBlue4; text-decoration: none; font-weight: bold;">public</font></a></code> <code><a href="../Keywords/void.html" title="Java Programming/Keywords/void"><font style="color:DodgerBlue4; text-decoration: none; font-weight: bold;">void</font></a></code> reflect() <code><a href="../Keywords/throws.html" title="Java Programming/Keywords/throws"><font style="color:DodgerBlue4; text-decoration: none; font-weight: bold;">throws</font></a></code> IllegalAccessException, IllegalArgumentException, InvocationTargetException {
    Secret instance = new Secret();
    <code><a href="../API/java.lang.Class.html" title="Java Programming/API/java.lang.Class">Class</a></code> secretClass = instance.getClass();

    <code><font style="color:#787878"><i>// Print all the method names &amp; execution result</i></font></code>
    Method methods[] = secretClass.getDeclaredMethods(); 
    System.out.println(<code><font style="color:DarkGreen; text-decoration: none; font-weight: bold;">"Access all the methods"</font></code>); 
    <code><a href="../Keywords/for.html" title="Java Programming/Keywords/for"><font style="color:DodgerBlue4; text-decoration: none; font-weight: bold;">for</font></a></code> (<code><a href="../Keywords/int.html" title="Java Programming/Keywords/int"><font style="color:DodgerBlue4; text-decoration: none; font-weight: bold;">int</font></a></code> i = 0; i &lt; methods.length; i++) { 
       System.out.println(<code><font style="color:DarkGreen; text-decoration: none; font-weight: bold;">"Method Name: "</font></code> + methods[i].getName());
       System.out.println(<code><font style="color:DarkGreen; text-decoration: none; font-weight: bold;">"Return type: "</font></code> + methods[i].getReturnType());
       methods[i].setAccessible(true);
       <b>System.out.println(methods[i].invoke(instance, EMPTY) + <code><font style="color:DarkGreen; text-decoration: none; font-weight: bold;">"\n"</font></code>);</b>
    }

    <code><font style="color:#787878"><i>//  Print all the field names &amp; values</i></font></code>
    Field fields[] = secretClass.getDeclaredFields();
    System.out.println(<code><font style="color:DarkGreen; text-decoration: none; font-weight: bold;">"Access all the fields"</font></code>);
    <code><a href="../Keywords/for.html" title="Java Programming/Keywords/for"><font style="color:DodgerBlue4; text-decoration: none; font-weight: bold;">for</font></a></code> (<code><a href="../Keywords/int.html" title="Java Programming/Keywords/int"><font style="color:DodgerBlue4; text-decoration: none; font-weight: bold;">int</font></a></code> i = 0; i &lt; fields.length; i++){ 
       System.out.println(<code><font style="color:DarkGreen; text-decoration: none; font-weight: bold;">"Field Name: "</font></code> + fields[i].getName()); 
       fields[i].setAccessible(true); 
       <b>System.out.println(fields[i].get(instance) + <code><font style="color:DarkGreen; text-decoration: none; font-weight: bold;">"\n"</font></code>);</b> 
    }
 }

 <code><a href="../Keywords/public.html" title="Java Programming/Keywords/public"><font style="color:DodgerBlue4; text-decoration: none; font-weight: bold;">public</font></a></code> <code><a href="../Keywords/static.html" title="Java Programming/Keywords/static"><font style="color:DodgerBlue4; text-decoration: none; font-weight: bold;">static</font></a></code> <code><a href="../Keywords/void.html" title="Java Programming/Keywords/void"><font style="color:DodgerBlue4; text-decoration: none; font-weight: bold;">void</font></a></code> main(String[] args){

   Hacker newHacker = <code><a href="../Keywords/new.html" title="Java Programming/Keywords/new"><font style="color:DodgerBlue4; text-decoration: none; font-weight: bold;">new</font></a></code> Hacker();
 
   <code><a href="../Keywords/try.html" title="Java Programming/Keywords/try"><font style="color:DodgerBlue4; text-decoration: none; font-weight: bold;">try</font></a></code> { 
     <b>newHacker.reflect();</b>
   }
   <code><a href="../Keywords/catch.html" title="Java Programming/Keywords/catch"><font style="color:DodgerBlue4; text-decoration: none; font-weight: bold;">catch</font></a></code> (Exception e) {
     e.printStackTrace();
   }
 }
}
</pre>
<p><b>Output:</b></p>
<pre>
Access all the methods
Method Name: getSecretCode
Return type: class java.lang.String
It's a secret
Access all the fields
Field Name: secretCode
It's a secret
</pre>
<p><i>(We need to add some explanation of what is going on here. --<a href="http://en.wikibooks.org/wiki/User:Djb" title="User:Djb">djb</a> 00:24, 14 March 2006 (UTC))</i></p>
<h3> <span class="mw-headline" id="JUnit_-_Test_Private_methods">JUnit - Test Private methods</span></h3>
<p>JUnit's are unit test cases, used to test the Java programs. Now you know how to test a private method using Reflection in JUnit.</p>
<p>There's a long-standing debate on whether testing private members is a good habit<sup id="cite_ref-0" class="reference"><a href="http://en.wikibooks.org/w/index.php?title=Java_Programming/Reflection/Accessing_Private_Features_with_Reflection&amp;printable=yes#cite_note-0">[1]</a></sup>;There are cases where you want to make sure a class exhibited the right behavior while not making the fields that need checking to assert that public (as it's generally considered bad practice to create accessors to a class just for the sake of a unit test). There's also cases when you can greatly simplify a test case by using reflection to test all smaller private methods (and their various branches), then test the main function.</p>
<p>With <a rel="nofollow" class="external text" href="http://dp4j.com">dp4j</a> it is possible to test private members without directly using the Reflection API but simply accessing them as if they were accessible from the testing method; dp4j injects the needed Reflection code at compile-time<sup id="cite_ref-1" class="reference"><a href="http://en.wikibooks.org/w/index.php?title=Java_Programming/Reflection/Accessing_Private_Features_with_Reflection&amp;printable=yes#cite_note-1">[2]</a></sup>.</p>
<p><br></p>





</div>				
								
				
				
												
								
												
				
				
								<div class="visualClear"></div>
				
								
			</div>
			</div></body></html>