<html><head><title>Java Programming/RMI-IIOP</title><link media="all" href="../../misc/modern.css" type="text/css" rel="stylesheet"></head><body class="mediawiki"><div id="content"><h1 class="firstHeading" id="firstHeading">Java Programming/RMI-IIOP</h1><div id="bodyContent">
								
				
				
								
				
				
																
				
				
								
				<div lang="en" dir="ltr" class="mw-content-ltr"><table id="toc" class="toc"><tr><td>
<div id="toctitle">
<h2>Contents</h2>
</div>
<ul><li class="toclevel-1 tocsection-1"><a href="http://en.wikibooks.org/w/index.php?title=Java_Programming/RMI-IIOP&amp;printable=yes#RMI-IIOP"><span class="tocnumber">1</span> <span class="toctext">RMI-IIOP</span></a>
<ul><li class="toclevel-2 tocsection-2"><a href="http://en.wikibooks.org/w/index.php?title=Java_Programming/RMI-IIOP&amp;printable=yes#The_Remote_Interface"><span class="tocnumber">1.1</span> <span class="toctext">The Remote Interface</span></a></li>
<li class="toclevel-2 tocsection-3"><a href="http://en.wikibooks.org/w/index.php?title=Java_Programming/RMI-IIOP&amp;printable=yes#The_Implementation_Class"><span class="tocnumber">1.2</span> <span class="toctext">The Implementation Class</span></a></li>
<li class="toclevel-2 tocsection-4"><a href="http://en.wikibooks.org/w/index.php?title=Java_Programming/RMI-IIOP&amp;printable=yes#The_Server_Class"><span class="tocnumber">1.3</span> <span class="toctext">The Server Class</span></a></li>
<li class="toclevel-2 tocsection-5"><a href="http://en.wikibooks.org/w/index.php?title=Java_Programming/RMI-IIOP&amp;printable=yes#The_Client_Class"><span class="tocnumber">1.4</span> <span class="toctext">The Client Class</span></a></li>
</ul></li>
</ul></td>
</tr></table><h2> <span class="mw-headline" id="RMI-IIOP">RMI-IIOP</span></h2>
<p>RMI-IIOP (RMI over IIOP) is provided with the Java SDK. It combines Remote Method Invocation (RMI) technology with the Internet Inter-Orb Protocol (IIOP) to provide CORBA to the Java platform. Java developers do not have to provide IDL in order to provide CORBA capabilities.</p>
<h3> <span class="mw-headline" id="The_Remote_Interface">The Remote Interface</span></h3>
<table width="75%"><tr><td style="background-color: #f2fff2; border: solid 1px #bfffbf; padding: 1em;" valign="top">
<p>//HowdyInterface.java</p>
<p>import java.rmi.Remote;</p>
<p>public interface HelloInterface extends java.rmi.Remote {</p>
<pre>
 public void sayHowdy() throws RemoteException;
</pre>
<p>}</p>
</td>
</tr></table><p>The above code defines a remote interface called HowdyInterface that will define what the remote client may call on the server. All of the operations must throw a RemoteException. The interface must extend java.rmi.Remote.</p>
<h3> <span class="mw-headline" id="The_Implementation_Class">The Implementation Class</span></h3>
<table width="75%"><tr><td style="background-color: #f2fff2; border: solid 1px #bfffbf; padding: 1em;" valign="top">
<p>//HowdyImpl.java</p>
<p>import javax.rmi.PortableRemoteObject;</p>
<p>import javax.rmi.RemoteException;</p>
<p>public class HowdyImpl implements HowdyInterface {</p>
<pre>
 public HelloImpl() throws java.rmi.RemoteException {
   PortableRemoteObject.exportObject(this);     // initializes the remote object
 }
</pre>
<pre>
 public void sayHowdy() throws RemoteException {
   System.out.println( "Weeee doggies!  Howdy!!" );
 }
</pre>
<p>}</p>
</td>
</tr></table><p>The implementation class allows for the object to be ORB-initialized. It also implements the remote operation to be called. The implementation could have extended PortableRemoteObject, in which case the exportObject call in the constructor would be removed. The better approach would seem to be as coded above.</p>
<h3> <span class="mw-headline" id="The_Server_Class">The Server Class</span></h3>
<table width="75%"><tr><td style="background-color: #f2fff2; border: solid 1px #bfffbf; padding: 1em;" valign="top">
<p>//HowdyServer.java</p>
<p>import javax.naming.InitialContext;</p>
<p>import javax.naming.Context;</p>
<p>import javax.rmi.PortableRemoteObject&#160;;</p>
<p>import com.sun.corba.se.internal.POA.POAORB;</p>
<p>import org.omg.PortableServer.*;</p>
<p>import java.util.*;</p>
<p>import org.omg.CORBA.*;</p>
<p>import javax.rmi.CORBA.Stub;</p>
<p>import javax.rmi.CORBA.Util;</p>
<p>public class HowdyServer {</p>
<pre>
 public HowdyServer(String[] args) {
   try {
     Properties p = System.getProperties();
     // add runtime properties here
     p.put("org.omg.CORBA.ORBClass", 
         "com.sun.corba.se.internal.POA.POAORB");
     p.put("org.omg.CORBA.ORBSingletonClass", 
         "com.sun.corba.se.internal.corba.ORBSingleton");
</pre>
<pre>
     ORB orb = ORB.init( args, p );
</pre>
<pre>
     POA rootPOA = (POA)orb.resolve_initial_references("RootPOA");
</pre>
<pre>
     Policy[] tpolicy = new Policy[3];
     tpolicy[0] = rootPOA.create_lifespan_policy(
       LifespanPolicyValue.TRANSIENT );
     tpolicy[1] = rootPOA.create_request_processing_policy(
       RequestProcessingPolicyValue.USE_ACTIVE_OBJECT_MAP_ONLY );
     tpolicy[2] = rootPOA.create_servant_retention_policy(
       ServantRetentionPolicyValue.RETAIN);
     POA tPOA = rootPOA.create_POA("MyTransientPOA", null, tpolicy);
         
     tPOA.the_POAManager().activate();
</pre>
<pre>
     HowdyImpl howdyImpl = new HowdyImpl();
     _HowdyImpl_Tie tie = (_HowdyImpl_Tie)Util.getTie( howdyImpl );
     String howdyId = "howdy";
     byte[] id = howdyId.getBytes();
     tPOA.activate_object_with_id( id, tie );
</pre>
<p><br></p>
<pre>
     Context initialNamingContext = new InitialContext();
     initialNamingContext.rebind("HowdyService", 
       tPOA.create_reference_with_id(id, 
         tie._all_interfaces(tPOA,id)[0]) );
     System.out.println("Howdy Server: Ready...");
     
     orb.run();
   } 
     catch (Exception e) {
       System.out.println("Error running HowdyServer: " + e);
       e.printStackTrace();
     } 
 }
</pre>
<pre>
 public static void main(String args[]) {
   new HowdyServer( args );
 }
</pre>
<p>}</p>
</td>
</tr></table><h3> <span class="mw-headline" id="The_Client_Class">The Client Class</span></h3>
<table width="75%"><tr><td style="background-color: #f2fff2; border: solid 1px #bfffbf; padding: 1em;" valign="top">
<p>//HelloClient.java</p>
<p>import java.rmi.RemoteException;</p>
<p>import java.net.MalformedURLException;</p>
<p>import java.rmi.NotBoundException;</p>
<p>import javax.rmi.*;</p>
<p>import java.util.Vector;</p>
<p>import javax.naming.NamingException;</p>
<p>import javax.naming.InitialContext;</p>
<p>import javax.naming.Context;</p>
<p>public class HelloClient {</p>
<pre>
 public static void  main( String args[] ) {
   Context ic;
   Object objref;
   HelloInterface hi;
</pre>
<pre>
   try {
     ic = new InitialContext();
   } catch (NamingException e) {
       System.out.println("failed to obtain context" + e);
       e.printStackTrace();
       return;
   }
       
   try {
     objref = ic.lookup("HowdyService");
     System.out.println("Client: Obtained a reference to Howdy server.");
   } catch (NamingException e) {
       System.out.println("failed to lookup object reference");
       e.printStackTrace();
       return;
   }
</pre>
<pre>
   try {
     hi = (HowdyInterface) PortableRemoteObject.narrow(
       objref, HowdyInterface.class);
     hi.sayHowdy();
   } catch (ClassCastException e) {
       System.out.println("narrow failed");
       e.printStackTrace();
       return;
     } catch( Exception e ) {
           System.err.println( "Exception " + e + "Caught" );
           e.printStackTrace( );
           return;
       }
 }
</pre>
<p>}</p>
</td>
</tr></table><p>The client code uses the name service to look up the server and make the remote invocation.</p>





</div>				
								
				
				
												
								
												
				
				
								<div class="visualClear"></div>
				
								
			</div>
			</div></body></html>